## 第四章 基于TCP的服务端/客户端（1）

### 理解TCP和UDP

TCP：Transmission Control Protocol 传输控制协议，即对数据传输过程的控制

#### 服务器端

##### 进入等待连接请求状态

在调用bind函数给套接字分配地址后可以使用listen函数进入等待连接状态：

```c
int listen(int sock, int backlog); // 成功时返回0，失败返回-1
```

参数：

- sock是希望进入等待连接状态的套接字
- backlog是连接请求等候队列的长度，例如为5，则队列长度为5，表示最多使5个连接请求进入队列

##### 受理客户端连接请求

```c
int accept(int sock, struct sockaddr* addr, socklen_t*addrlen);
```

accept函数成功时返回创建的套接字，这个套接字是accept函数自动创建并连接到发起请求的客户端的，是用来和客户端进行数据交互。

注意与客户端进行交互的不是那个参数sock套接字，因为sock套接字是服务器的套接字是用来等待连接请求的。

参数：

- sock是服务器套接字
- addr是保存发起请求的客户端地址信息的变量地址值，也就是说起初先声明一个客户端地址信息结构体，调用函数后向这个结构体填充客户端地址信息。
- addrlen是第二个参数结构体的长度

#### 客户端

客户端的IP地址和端口号是在调用connect函数时自动分配的，无需调用bind函数进行分配。