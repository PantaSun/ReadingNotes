## 协议

协议就是计算机与计算机之间通过网络实现通信系统时事先达成的一种“约定”。

两台计算机之间必须能够支持相同的协议，并遵循相同协议进行处理，这样才能实现相互通信。

## 协议分层与OSI参考模型

分层可以使比较复杂的网络简单化。

在OSI参考模型中，一共分为7层。每个分层都接收下一层所提供的特定的服务，并为自己的上一层提供特定的服务。上下层之间交互所遵循的约定叫做接口，同一层之间的交互所遵循的约定叫做协议。

分层的优点：将每个分层独立使用，即使某个分层发生变化，也不会波及整个系统；分层后系统具有较强的扩展性和灵活性；分层能够细分通信功能，更易于实现每个分层的协议，并界定各个分层的具体责任和义务。

### OSI参考模型

从上到下：

- 应用层：为应用程序提供服务并规定应用程序中通信相关的细节。
- 表示层：
  - 将应用处理的信息转换为适合网络传输的格式，或者将来自下一层的数据转换为上一层能够处理的数据格式。即主要就是负责数据格式转换。
  - 表示层，顾名思义，表示数据的一层，所以该层更关注数据的具体表现形式。因为相同的数据在不同的计算机之间的表现形式是不同的，在计算机中一切数据归根到底就是一串0、1序列。而0、1序列在不同计算机中的存贮方式是不同的，有大端法和小端法两种。表示层就可以解决这个问题，不管数据在计算机中的格式如何，都将它们转换成“网络通用的标准数据格式”，这样异构计算机之间也能保持数据一致。
  - 总结起来就是，表示层是进行“统一的网络数据格式”与“某一台计算机或某一特定应用的数据格式”之间相互转换的分层。
- 会话层：负责建立和断开通信连接，以及数据的分割等数据相关的管理（注意这里是建立和断开通信连接的“管理”，而不是进行实际的建立和断开处理）。决定采用何种连接方式（何时建立连接、何时发送数据）是会话层的主要责任。不具有实际传输数据的动能。
- 传输层：
  - 起着可靠传输的作用。只在通信双方节点上进行处理，而无需在路由器上处理。（后面这句没看懂，好像是确保数据被可靠的传送到目标地址，这个目标地址就是目标节点吧？）
  - 进行建立连接或断开连接的处理，这里与会话层是有区别的。在两个主机之间创建逻辑上的通信连接即是传输层的主要作用。
  - 传输层会在通信两端的计算机之间进行确认，若数据未送达，它会负责进行重发。
- 网络层：将数据传输到目标地址。这一层主要负责地址管理（寻址）与路由选择。两个主机之间虽然有众多数据链路，但能够将数据从主机A发送到主机B是网络层的功劳。
- 数据链路层：负责物理层面上的互连的、节点之间的通信传输。互连设备之间传送和识别数据帧。
- 物理层：负责0、1比特流与高低、光的闪灭之间的转换。相互直连的设备之间使用地址实现传输，这种地址被称为MAC地址

在层之间传输的数据都有一个对应每一层的头部，剩下部分就是数据的内容。处理上一层传来的数据时，这个数据就是当前层数据的内容，当前层还要在该数据内容上加上当前层协议所必须的头部信息，组合成当前层数据（内容+头部）。处理下一层传来的数据时，要将数据的内容和头部分离，再将数据的内容转发给上一层。

从上到下，每一层都给数据加一个属于当前层的头；从下到上，每一层都从数据中将属于当前层的头剥离。

在不同层协议中，连接有不同的含义：

- 在**数据链路层**中，连接就是指**物理的、通信线路**的连接
- 在**传输层**的连接是指负责创建与管理**逻辑上**的连接。

### 电路交换与分组交换

#### 电路交换

多台计算机连接到交换机上，交换机与交换机之间由众多通信线路连接。当通信线路上的两台主机想要进行通信时，要先建立连接。即需要通过交换机与目标主机连理通信连接。当连接建立成功后，两台主机就独占线路进行数据传输。这时电路上的其他主机之间就无法交流。



#### 分组交换

将连接到通信电路商的计算机所要发送的数据分成多个数据包，按照一定的顺序排列之后分别发送，这就是分组交换。

在数据被细分后，同一电路上的所有计算机可以一齐收发数据，提高了通信线路的利用率。

数据被分成包后，每个数据包的首部都写入了发送端和接收端的地址，这样就可以明确区分每个分组数据发往的目的地，以及它是与哪台计算机进行通信。

分组交换机又叫路由器。分组交换的大致过程是：发送端计算机将数组分组发送给路由器，路由器收到这些分组数据后，缓存到自己的缓冲区，然后再转发给目标计算机。因此分组交换又叫蓄积交换。



## 网络构成要素

- 网卡： 网络接口卡，Network interface card，NIC，使计算机连网的设备

- 中继器Repeater：从物理层上延长网络的设备。由电缆传过来的电信号或光信号经由中继器的波形调整和放大再传给另一个电缆。中继器不能再传输速度不同的媒介之间转发。中继器不能无限使用。中继器不能判断数据是否有错误，只负责转发。

- 网桥（2层交换机）：

  - 从数据链路层上延长网络的设备。可以识别数据帧，将收到的数据帧临时存储于内存，再重新生成信号作为一个新的帧转发给相连的另一个网段。

  - 网桥可以连接不同传输速率的数据链路。
  - 网桥不限制连接网段的个数
  - 网桥可以识别数据的完整性，若数据不完整则不会转发。数据帧中有一个FCS数据为，用以检验数据是否正确送达目的地。网桥就是通过检查这个值来判断接受的数据是否完整。
  - 网桥还可以通过地址自学机制和过滤功能控制网络流量。这里地址是指MAC地址，即网络上针对NIC分配的地址。

- 路由器（3层交换机）：通过网络层转发分组数据的设备。路由器是根据IP地址进行处理的。路由器可以连接不同的数据链路。

- 4-7层交换机：处理传输层以上的各层网络传输的设备。例如企业中使用的负载均衡器。

- 网关：转换协议的设备。是OSI参考模型中负责将传输层到应用层的数据进行转换和转发的设备。类似于4-7层交换机都是处理传输层及以上的数据，但是网关不仅转发数据还要负责对数据进行转换。通常会使用一个表示层或应用层网关，在两个不能进行直接通信的协议之间进行翻译。



## 其他

### 虚拟化技术

当一个网站需要调整运营所需的资源时，并不增减服务器、存储设备、网络等实际的物理设备，而是利用软件将这些物理设备虚拟化，在有必要增减资源的时候，通过软件按量增减的一种机制。通过此机制实现按需分配、按比例分配，对外提供可靠地服务。

使用虚拟化技术，根据使用者的情况动态调整必要资源的机制被人们称为云。

