## 重点内容

- 临界区问题
- 基于硬件的同步
- 信号量机制
- 经典同步问题
- 管程

## 背景

共享数据的并发访问可能产生数据的不一致。而进程同步机制就是用来确保共享同一逻辑地址空间的协作进程（这个并不是协程）可有序的执行，从而维护数据的一致性。

## 临界区问题

**1.临界资源**

临界资源是一次仅允许一个进程使用的共享资源。*各进程采取互斥的方式，实现共享的资源称作临界资源。*属于临界资源的硬件有，打印机，磁带机等；软件有消息队列，变量，数组，缓冲区等。诸进程间采取互斥方式，实现对这种资源的共享。

**2.临界区：**

每个进程中访问临界资源的那段代码称为临界区（*criticalsection*），每次只允许一个进程进入临界区，进入后，不允许其他进程进入。不论是硬件临界资源还是软件临界资源，多个进程必须互斥的对它进行访问。*多个进程涉及到同一个临界资源的的临界区称为相关临界区。*使用临界区时，一般不允许其运行时间过长，只要运行在临界区的线程还没有离开，其他所有进入此临界区的线程都会被挂起而进入等待状态，并在一定程度上影响程序的运行性能。



每个进程必须请求允许进入临界区。实现这一请求的代码段称为进入区，临界区之后可有退出去，其它代码为剩余区。



**3. 临界区的使用原则**

- 互斥：如果一个进程在其临界区执行，则其他进程都不能在其临界区内执行（忙则等待）
- 前进：如果没有进程在其临界区内执行且有进程需要进入临界区，那么只有那些不在剩余区内执行的进程可参加选择，以确定下一个进入临界区，且这种选择不能无限推迟。（空闲让进）
- 有限等待：从一个进程作出进入临界区的请求，直到该请求允许为止，其他进程允许进入其临界区的次数有上限。
- 让权等待：不能忙等，要让出CPU