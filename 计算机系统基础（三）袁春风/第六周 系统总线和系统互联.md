## 总线的基本概念

#### 总线裁决

- 早期：总线多是共享传输，需确定哪个设备使用总线
- 现在：总线多是点对点传输，无需裁决

#### 总线定时

定义总线实务中的每一步何时开始、何时结束。

Synchronous（同步）：用时钟信号来确定每个步骤

Asynchronous（异步）：用握手信号来定时，前一个信号结束就是下一个信号的开始

半同步：结合使用时钟信号的握手信号来定时

#### 并行/串行传输

并行：一个方向同时传输多位数据信号，故位与位需同步，慢

串行：一个方向只传输一位数据信号，无需在位之间同步，快

### 总线的性能指标

- 总线宽度：总线中数据线的条数，决定了每次能同时传输的信息位数
- 总线工作频率：每秒传送次数（MT/s或GT/s）。早期的总线通常一个时钟传送一次数据，此时，工作频率等于总线时钟频率；现在一个时钟周期发送两次或四次数据，因此，工作频率是时钟频率的2倍或4倍。
- 总线带宽：
  - 总线的最大数据传输率
  - 总线带宽计算公式：B = W * F/N，W为总线宽度，F为总线时钟频率，N为完成一个数据传送所用时间周期。F/N实际上是总线的工作频率。
- 总线传送方式
  - 非突发传送：每个总线事务都是传送地址，一个地址对应一次数据传送
  - 突发传送：成块数据传送。突发传送总线事务中，先传送一个地址，后传送多次数据，后续数据的地址默认为前面地址自动增量。



## 三种总线和系统互联

### CPU（前端）总线

#### 早期前端总线Front Side Bus，FSB

- 位于CPU芯片与北桥芯片之间互连
- 从Pentium pro开始，FSB采用quad pumped技术：每个时钟周期传送4次数据
- 并行传输、同步定时方式

#### 目前QPI（Quick Path Interconnect）总线

- 现在的Intel架构中CPU芯片内核之间、CPU芯片之间、CPU芯片与IOH（IO Hub）芯片之间，都通过QPI总线互连。
- QPI是基于包交换的串行、高速点对点连接：发送方和接受方各有时钟信号，双方同时传输数据（各有20条数据线），每个QPI数据包含80位，分两个时钟周期传送，每个时钟周期传两次，故每次传20位（16位数据+4位校验位）
- QPI总线带宽：每秒传送次数 * 2B * 2。

### IO总线

I/O总线用于为系统中的各种IO设备提供输入输出通道。