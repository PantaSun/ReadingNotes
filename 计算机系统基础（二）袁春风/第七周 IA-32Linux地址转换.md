## IA-32的地址转换

### IA-32的存储管理

- 按字节编址
- 在保护模式下，IA-32采用段页虚拟存储管理方式
- 存储地址采用逻辑地址、线性地址和物理地址（逻辑地址到线性地址的转换由分段完成，线性地址到物理地址的转换由分页完成）：逻辑地址和线性地址是虚拟地址的两种不同表示形式，描述的都是4GB虚拟地址空间中的一个存储地址。
- 逻辑地址有48位：16位段选择符和32位段内偏移量
- 线性地址32位
- 物理地址32位



### IA-32处理器逻辑地址到线性地址转换

#### IA-32处理器的寻址方式

举例：

`movw 8(%ebp, %edx, 4), %ax  // R[ax] <= M[R[ebp] + R[edx] * 4 +8]`

- 这里`8`是偏移量 `A`
- `%ebp`是基址寄存器 `B`
- `%edx`是变址寄存器 `I`
- `4` 是比例因子 `S`
- 还有一个隐含的段寄存器（`SR`）
- 有效地址 `EA = （B）+（I）*S + A`，有效地址其实就是段内的偏移量

所以线性地址 `LA = （SR）+ EA`  即  `LA = （SR）+（B）+（I）*S + A`

LA的由来：根据SR段寄存器中的 段选择符Index去段表中找到相应的段表项（描述段的信息，如段长，段的起始地址等），从中获取段基址，再加上有效地址最后得到线性地址。

段表在主存中。

之后再由线性地址分页，根据页表得到物理地址。