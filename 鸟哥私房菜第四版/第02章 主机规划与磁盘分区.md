## 主机规划与磁盘分区

### 各硬件装置在Linux中的文件名

- Linux系统中几乎所有硬件装置文件都在/dev这个目录内


- SCSI/SATA/USB 硬盘等的接口文件名为：/dev/sd[a-p]
- 因特网供货商（ISP）提供的云主机内，磁盘文件名为/dev/vd[a-p]

### 磁盘分区

- SATA/USB接口的顺序是根据Linux核心检测倒的磁盘顺序，不一定是根据插槽编号来决定顺序。

#### MBR与GPT磁盘分区表

##### MBR

- 通常一个磁盘有多个磁盘盘，所有磁盘盘的同一磁道称为磁柱（Cylinder）


- 主要开机记录区，MBR（Master Boot Record）：早期Linux系统为了兼容Windows系统，使用支持Windows系统的MBR的方式处理开机管理程序与分区表。开机管理程序记录区与分区表都放在磁盘的第一个扇区，这个扇区通常是512bytes：
  - MBR：可以安装开机管理程序的地方，有446bytes
  - 分区表（partition table）：记录整颗硬盘分区的状态，64bytes
- 由于分区表大小为64bytes，所以最多仅能记录四组记录区，每组记录区记录了该区段的起始与结束的磁柱号码。这四组分区信息称为主要（primary）分区或延伸（Extended）分区
- 假设磁盘的文件名为/dev/sda时，则分区名如下：
  - P1：/dev/sda1
  - P2：/dev/sda2
  - P3：/dev/sda3
  - P4：/dev/sda4
- 分区的最最小单位通常为磁柱
- 虽然第一扇区所在的分区表只能记录四笔数据，但仍可以分出不止四个分区槽。
- 可以通过延伸分区来分更多的区，使用额外的扇区来记录分区信息。就是先把磁盘分为两大区，第一大区为主分区，第二大区为延伸分区，然后在这个延伸分区中再分出几个区。也就是可以透过延伸分区所指向的那个区快继续作分区的记录。
- 由延伸分区切出来的分区被称为逻辑分区槽。逻辑分区只能在延伸分区所设定的范围内。
- 逻辑分区槽的设备名称号码是从5开始的。因为1、2、3、4编号只能分配给主分区或延伸分区，即使没有分配这么多分区，这些编号也要保留，不能分配给逻辑分区使用。
- 延伸分区最多只能有一个（操作系统的限制）
- 主分区和逻辑分区都能格式化，但延伸分区本身不能格式化。
- 过去的MBR分区表有很多限制
  - 操作系统无法抓取到2.2T以上的磁盘容量。
  - MBR只有一个区块，若被破坏，经常无法或难救援。
  - MBR内存放开机管理程序的区块仅仅446bytes，无法容纳更多的程序代码。



##### GUID partition table，GPT 磁盘分区表

- GPT将磁盘所有区块以512bytes大小的逻辑区块地址（Logical Block Address，LBA）来规划。
- 第一个LBA称为LBA0与MBR的分区表兼容，储存了第一阶段的开机管理程序。
- GPT使用34个区块来记录分区信息。且在整个磁盘最后还有33个LBA作为备份。
- LBA1作为GPT表头记录，里面记录了分区表本身的位置和大小，以及备份GPT的位置。还放置了CRC32检验机制码，操作系统根据这个码来判断GPT是否正确，若不正确就去备份GPT来恢复GPT。
- LBA2开始，每个LBA记录4个分区记录。

#### 开机的流程

- BIOS->MBR->boot loader ->核心文件

### Linux安装模式下，磁盘分区的选择

#### 文件系统与目录树的挂载

- 挂载：利用一个目录当作进入点，将磁盘分区槽的数据放置在该目录下，进入该目录就能读取该分区槽。
- ​

